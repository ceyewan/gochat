# GoChat API 接口文档

## 概述

GoChat API 提供用户认证和消息推送功能，所有接口采用 JSON 格式进行数据交换。

## 通用响应状态码

| 状态码 | 描述 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权/认证失败 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 业务状态码

| 状态码 | 描述 |
|--------|------|
| 200 | 成功 |
| 400 | 失败 |

## 错误响应格式

当请求失败时，API 会返回以下格式的错误信息：

```json
{
  "code": 400,
  "error": "错误描述信息"
}
```

## 用户认证接口

### 1. 用户注册

- **URL**: `/user/register`
- **方法**: POST
- **需要认证**: 否
- **请求参数**:

```json
{
  "username": "用户名",
  "password": "密码"
}
```

- **成功响应**:

```json
{
  "code": 200
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "注册失败，用户名可能已存在"
}
```

### 2. 用户登录

- **URL**: `/user/login`
- **方法**: POST
- **需要认证**: 否
- **请求参数**:

```json
{
  "username": "用户名",
  "password": "密码"
}
```

- **成功响应**:

```json
{
  "code": 200,
  "user_id": 123,
  "username": "用户名",
  "token": "身份验证令牌"
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "登录失败，用户名或密码错误"
}
```

### 3. 身份验证检查

- **URL**: `/user/checkAuth`
- **方法**: POST
- **需要认证**: 是
- **请求参数**:

```json
{
  "token": "身份验证令牌"
}
```

- **成功响应**:

```json
{
  "code": 200
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "认证失败，令牌无效或已过期"
}
```

### 4. 用户登出

- **URL**: `/user/logout`
- **方法**: POST
- **需要认证**: 是
- **请求参数**:

```json
{
  "token": "身份验证令牌"
}
```

- **成功响应**:

```json
{
  "code": 200
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "登出失败，令牌可能已过期"
}
```

## 消息推送接口

### 1. 单聊消息推送

- **URL**: `/push/push`
- **方法**: POST
- **需要认证**: 是
- **请求参数**:

```json
{
  "msg": "消息内容",
  "to_user_id": 123,
  "to_user_name": "接收用户名",
  "from_user_id": 456,
  "from_user_name": "发送用户名",
  "room_id": 0,
  "token": "身份验证令牌"
}
```

- **成功响应**:

```json
{
  "code": 200
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "发送消息失败"
}
```

### 2. 群聊消息推送

- **URL**: `/push/pushRoom`
- **方法**: POST
- **需要认证**: 是
- **请求参数**:

```json
{
  "msg": "消息内容",
  "to_user_id": 0,
  "to_user_name": "",
  "from_user_id": 456,
  "from_user_name": "发送用户名",
  "room_id": 789,
  "token": "身份验证令牌"
}
```

- **成功响应**:

```json
{
  "code": 200
}
```

- **失败响应**:

```json
{
  "code": 400,
  "error": "发送消息失败"
}
```

## 认证机制

所有需要认证的接口都必须在请求中包含有效的 token。认证通过中间件 `CheckSessionId()` 实现，未通过认证的请求将返回 401 状态码。

## 跨域支持

API 支持跨域资源共享 (CORS)，允许来自任何源的请求。OPTIONS 预检请求会自动返回 200 状态码。
