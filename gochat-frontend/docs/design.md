你要为实现一个分布式微服务即时通讯系统的前端部分，此项目面向就业面试，不用特别复杂，你面对的开发者是后端开发人员。

前端界面需要满足以下要求：
1. 具有简要的用户界面，设计要简洁直观，易于操作。
2. 实现会话管理功能，能够清晰展示当前的会话列表，包括单聊和群聊。
3. 具备普通的文字消息发送功能，可在单聊和群聊会话中发送文字消息。


<设计方案>
# 一、界面整体布局设计
采用即时通讯应用经典的**三栏式布局**（适配桌面端，简洁直观），整体结构如下：
```
+-------------------+-----------------------------------------------+
|  顶部导航栏        |                 聊天主界面                      |
+-------------------+-----------------------------------------------+
|  左侧会话列表栏    |  聊天记录区域（滚动）                           |
|  （固定宽度250px） |  +-------------------------------------------+  |
|                   |  |  消息1（左/右气泡）                       |  |
|                   |  |  消息2（左/右气泡）                       |  |
|                   |  +-------------------------------------------+  |
|                   |  消息输入区域（固定底部）                       |
+-------------------+-----------------------------------------------+
```

### 1. 顶部导航栏（高度50px）
- **左侧**：显示当前登录用户的**头像**（默认占位图，圆形）、**用户名**（如“张三”）；
- **右侧**：**登出按钮**（文字按钮， hover时变蓝），点击触发登出流程。

### 2. 左侧会话列表栏（宽度250px）
- **顶部**：“会话列表”标题（字体16px， padding 10px）；
- **中间**：会话列表容器（overflow-y auto），每个会话项（高度60px）包含：
  - 左侧：联系人/群**头像**（圆形40px，默认图）；
  - 中间：**名称**（字体14px加粗）、**最后一条消息预览**（字体12px灰色，超出用省略号）；
  - 右侧：**未读消息计数**（红色圆形badge，如“2”）、**最后消息时间**（字体12px灰色）；
- **底部**：两个操作按钮（图标+文字）：**添加好友**、**创建群聊**（触发弹窗）。

### 3. 右侧聊天主界面（占剩余宽度）
- **聊天记录区域**（flex:1，overflow-y auto）：
  - 发送方消息：右侧对齐，蓝色背景气泡（#0078ff），白色文字， padding 10px， border-radius 10px， max-width 60%；
  - 接收方消息：左侧对齐，白色背景气泡（#fff），灰色边框， padding 10px， border-radius 10px， max-width 60%；
  - 每条消息下方：**发送时间**（字体12px灰色， margin-top 5px）；
- **消息输入区域**（高度80px，固定底部）：
  - 左侧：**文本输入框**（textarea，resize:vertical，border:none，padding 10px，font-size 14px，flex:1）；
  - 右侧：**发送按钮**（蓝色背景#0078ff，白色文字， width 80px， height 40px， border-radius 5px， cursor:pointer）。


# 二、核心功能模块设计与后端交互逻辑
## 1. 用户认证模块（登录/注册/登出）
### （1）登录界面
- **布局**：居中卡片（宽度300px），包含“用户名”输入框、“密码”输入框（密码隐藏）、“登录”按钮，底部有“还没有账号？注册”链接。
- **交互逻辑**：
  - 点击“登录”：校验输入不为空后，调用后端HTTP接口`POST /api/auth/login`（参数：`username`、`password`）；
  - 成功响应：保存`token`到`localStorage`（key: `auth_token`），获取用户信息（`userId`、`username`、`avatar`）存入前端状态，跳转到主界面；
  - 失败响应：提示错误信息（如“用户名或密码错误”）。

### （2）注册界面
- **布局**：与登录界面类似，增加“确认密码”输入框，底部有“已有账号？登录”链接。
- **交互逻辑**：
  - 点击“注册”：校验密码一致且不为空后，调用后端HTTP接口`POST /api/auth/register`（参数：`username`、`password`）；
  - 成功响应：跳转到登录界面；
  - 失败响应：提示错误信息（如“用户名已存在”）。

### （3）登出功能
- **交互逻辑**：
  - 点击顶部“登出”按钮：调用后端HTTP接口`POST /api/auth/logout`（携带`token`）；
  - 成功响应：清除`localStorage`中的`token`和前端状态，跳转到登录界面。


## 2. 会话管理模块（会话列表）
### （1）会话列表加载
- **触发时机**：主界面初始化（登录成功后）。
- **交互逻辑**：
  - 从`localStorage`取出`token`，设置到HTTP请求的`Authorization` header（`Bearer ${token}`）；
  - 调用后端HTTP接口`GET /api/conversations`，获取当前用户的**所有会话列表**（单聊+群聊），响应示例：
    ```json
    [
      {
        "conversationId": "conv_123",
        "type": "single", // 单聊
        "target": { "userId": "user_456", "username": "李四", "avatar": "default.png" },
        "lastMessage": "今天吃火锅吗？",
        "unreadCount": 2,
        "lastMessageTime": "2024-05-20 14:30:00"
      },
      {
        "conversationId": "group_789",
        "type": "group", // 群聊
        "target": { "groupId": "group_789", "groupName": "前端技术群", "avatar": "group.png" },
        "lastMessage": "有没有人会React？",
        "unreadCount": 0,
        "lastMessageTime": "2024-05-20 14:00:00"
      }
    ]
    ```
  - 将会话列表存入前端状态（如Vuex的`conversations`），渲染到左侧会话列表栏。

### （2）会话切换
- **交互逻辑**：
  - 点击某个会话项：更新前端状态中的`currentConversation`（当前选中会话）；
  - 调用后端HTTP接口`GET /api/conversations/{conversationId}/messages`，获取该会话的**历史消息列表**，响应示例：
    ```json
    [
      {
        "messageId": "msg_001",
        "senderId": "user_456",
        "senderName": "李四",
        "content": "今天吃火锅吗？",
        "sendTime": "2024-05-20 14:30:00"
      },
      {
        "messageId": "msg_002",
        "senderId": "user_123",
        "senderName": "张三",
        "content": "好的，晚上7点见！",
        "sendTime": "2024-05-20 14:31:00"
      }
    ]
    ```
  - 将历史消息存入前端状态（如`currentMessages`），渲染到聊天记录区域，并自动滚动到底部（显示最新消息）。


## 3. 聊天交互模块（消息发送/接收）
### （1）文字消息发送
- **交互逻辑**：
  - 用户在输入框输入文字，点击“发送”按钮（或按回车键）：
    - 校验输入不为空；
    - 构造消息对象（示例）：
      ```json
      {
        "conversationId": "conv_123", // 当前选中会话ID
        "type": "text", // 消息类型（文本）
        "content": "晚上7点在楼下集合！"
      }
      ```
    - 通过**WebSocket**发送消息（WS连接在主界面初始化时建立，url示例：`ws://localhost:8080/ws?token=${token}`）；
    - 前端先将消息添加到`currentMessages`（标记为“发送中”状态），优化用户体验；
  - 后端WS服务收到消息后，处理并推送给对方（单聊）或群成员（群聊）；
  - 前端收到后端推送的**消息确认**（如`type: 'message-ack'`）后，更新消息状态为“已发送”。

### （2）实时消息接收
- **交互逻辑**：
  - 主界面初始化时，建立WS连接，监听`onmessage`事件；
  - 收到后端推送的**新消息**（示例）：
    ```json
    {
      "type": "new-message",
      "data": {
        "conversationId": "conv_123",
        "message": {
          "messageId": "msg_003",
          "senderId": "user_456",
          "senderName": "李四",
          "content": "没问题！",
          "sendTime": "2024-05-20 14:35:00"
        }
      }
    }
    ```
  - 处理逻辑：
    - 如果`conversationId`等于当前选中的会话ID：将消息添加到`currentMessages`，滚动到聊天记录底部；
    - 否则：更新对应会话项的`lastMessage`、`lastMessageTime`和`unreadCount`（+1），显示未读小红点。


## 4. 联系人与群管理模块（添加好友/创建群聊）
### （1）添加好友
- **触发时机**：点击左侧会话列表栏底部的“添加好友”按钮，弹出对话框。
- **对话框布局**：包含“好友用户名”输入框、“搜索”按钮，搜索成功后显示好友信息（头像、用户名）和“添加好友”按钮。
- **交互逻辑**：
  - 输入用户名，点击“搜索”：调用后端HTTP接口`GET /api/users/{username}`，获取好友信息（示例）：
    ```json
    {
      "userId": "user_789",
      "username": "王五",
      "avatar": "default.png"
    }
    ```
  - 显示好友信息，点击“添加好友”：调用后端HTTP接口`POST /api/friends`（参数：`friendId`）；
  - 成功响应：关闭对话框，后端自动创建单聊会话，前端更新`conversations`列表（添加新会话项）。

### （2）创建群聊
- **触发时机**：点击左侧会话列表栏底部的“创建群聊”按钮，弹出对话框。
- **对话框布局**：包含“群名称”输入框、“选择好友”下拉框（从好友列表中选择）、“创建”按钮。
- **交互逻辑**：
  - 输入群名称，选择好友（示例：李四、王五），点击“创建”：调用后端HTTP接口`POST /api/groups`（参数：`groupName`、`members`）；
  - 成功响应：关闭对话框，后端返回群信息（示例）：
    ```json
    {
      "groupId": "group_001",
      "groupName": "周末爬山群",
      "avatar": "group.png",
      "members": ["user_123", "user_456", "user_789"]
    }
    ```
  - 前端更新`conversations`列表（添加群聊会话项）。


## 5. 在线状态显示模块（好友/群成员）
### （1）好友在线状态
- **交互逻辑**：
  - 登录成功后，WS连接建立，后端推送当前用户的**好友在线状态列表**（示例）：
    ```json
    {
      "type": "friend-online",
      "data": [
        { "userId": "user_456", "online": true }, // 在线（绿色小点）
        { "userId": "user_789", "online": false } // 离线（灰色小点）
      ]
    }
    ```
  - 前端将在线状态存入`onlineStatus`（对象，key: userId，value: boolean）；
  - 渲染会话列表项时，根据`onlineStatus`显示头像旁的**状态指示灯**（绿色=在线，灰色=离线）；
  - 当好友在线状态变化（如离线），后端推送`friend-online`事件，前端实时更新状态指示灯。

### （2）群成员在线状态
- **交互逻辑**（简化版）：
  - 进入群聊会话时，后端推送群成员在线状态（示例）：
    ```json
    {
      "type": "group-member-online",
      "data": {
        "groupId": "group_789",
        "members": [
          { "userId": "user_123", "online": true },
          { "userId": "user_456", "online": false }
        ]
      }
    }
    ```
  - 前端在聊天主界面右侧（可选）显示群成员列表，标注在线状态（绿色小点）；
  - 状态变化时，后端推送事件，前端实时更新。


# 三、技术选型建议（适配后端开发人员）
- **框架**：Vue.js（轻量级，文档齐全，适合快速开发）；
- **状态管理**：Vuex（集中管理会话、用户、消息等状态，便于调试）；
- **HTTP请求**：Axios（支持拦截器，方便设置`token`和处理错误）；
- **WebSocket**：原生`WebSocket` API（无需额外依赖，逻辑清晰）；
- **样式**：CSS3（用flex布局实现响应式，保持简洁）；
- **构建工具**：Vite（快速启动，热更新，适合开发调试）。


# 四、关键细节优化
1. **未读消息计数**：
   - 用`localStorage`保存未读计数，避免刷新页面丢失；
   - 点击会话项时，调用后端接口`PUT /api/conversations/{conversationId}/read`，重置未读计数为0。

2. **消息滚动**：
   - 每次添加新消息时，用`element.scrollIntoView({ behavior: 'smooth' })`自动滚动到聊天记录底部。

3. **输入框优化**：
   - 用`textarea`实现自动高度调整（监听`input`事件，动态设置`rows`属性）；
   - 支持回车键发送消息（监听`keydown`事件，`Enter`键触发发送）。

4. **WS连接稳定性**：
   - 监听`onclose`事件，自动重连（间隔1秒，最多重连3次）；
   - 重连时携带`token`，确保身份验证有效。


# 五、与后端接口的对应关系
| 前端功能         | 后端HTTP接口                | 后端WS事件/接口            |
|------------------|-----------------------------|----------------------------|
| 用户登录         | `POST /api/auth/login`      | ——                         |
| 用户注册         | `POST /api/auth/register`   | ——                         |
| 用户登出         | `POST /api/auth/logout`     | ——                         |
| 获取会话列表     | `GET /api/conversations`    | ——                         |
| 获取历史消息     | `GET /api/conversations/{id}/messages` | ——             |
| 添加好友         | `POST /api/friends`         | ——                         |
| 创建群聊         | `POST /api/groups`          | ——                         |
| 发送文字消息     | ——                         | `send`（消息对象）         |
| 接收实时消息     | ——                         | `new-message`（事件）      |
| 获取好友在线状态 | ——                         | `friend-online`（事件）    |
| 获取群成员在线状态| ——                         | `group-member-online`（事件）|


# 六、界面原型示意图（文字描述）
### 1. 登录界面
```
[ 用户名输入框 ]
[ 密码输入框 ]
[ 登录按钮 ]
[ 还没有账号？注册 ]
```

### 2. 主界面
```
[ 头像 张三 | 登出 ]
+-------------------+-----------------------------------------------+
|  会话列表          |  [李四]的聊天记录                              |
|  +---------------+  +-------------------------------------------+  |
|  | 李四（头像）  |  | 李四：今天吃火锅吗？（左气泡）             |  |
|  | 最后消息：...  |  | 张三：好的，晚上7点见！（右气泡）           |  |
|  | 未读：2        |  +-------------------------------------------+  |
|  +---------------+  [输入框：晚上7点在楼下集合！] [发送]          |
|  | 前端技术群     |                                             |
|  | 最后消息：...  |                                             |
|  +---------------+                                             |
|  [添加好友] [创建群聊]                                          |
+-------------------+-----------------------------------------------+
```


# 七、总结
本设计方案以**简洁、直观、易操作**为核心，覆盖了后端提供的所有核心功能（注册/登录、会话管理、消息发送/接收、在线状态）。界面布局符合用户使用习惯，交互逻辑清晰，与后端接口的对应关系明确，适合后端开发人员快速理解和对接。同时，通过状态管理（Vuex）和WebSocket实时通信，确保了前端数据的一致性和实时性。
</设计方案>